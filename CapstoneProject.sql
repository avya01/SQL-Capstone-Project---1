CREATE TABLE IF NOT EXISTS SALESMAN(
  SALESMAN_ID INTEGER PRIMARY KEY,
  NAME TEXT,
  CITY TEXT,
  COMMISSION INTEGER
);

INSERT INTO SALESMAN (SALESMAN_ID, NAME, CITY, COMMISSION) 
VALUES(1, 'John Doe', 'New York', 500),
(2, 'Jane Smith', 'Los Angeles', 750),
(3, 'Michael Brown', 'Chicago', 600),
(4, 'Emma Johnson', 'Houston', 650),
(5, 'Robert Davis', 'Phoenix', 700),
(6, 'Sophia Martinez', 'Philadelphia', 550),
(7, 'Liam Garcia', 'San Antonio', 620),
(8, 'Olivia Wilson', 'Dallas', 680);

CREATE TABLE CUSTOMERS(
  CUSTOMER_ID INTEGER PRIMARY KEY,
  NAME TEXT,
  CITY TEXT,
  SALESMAN_ID INTEGER,
  FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID)
);


INSERT INTO CUSTOMERS (CUSTOMER_ID, NAME, CITY, SALESMAN_ID)
VALUES(3002, 'nick rimando', 'New York', 1),
(3007, 'brad davis', 'New York', 1),
(3005, 'graham zusi', 'california', 8),
(3008, 'julian green', 'london', 6),
(3004, 'fabian johnson', 'paris', 8),
(3009, 'geoff cameron', 'berlin', 5),
(3003, 'jozy altidor', 'moscow', 7),
(3001, 'brad guzan', 'london', 4);

CREATE TABLE ORDERS(
  ORDER_ID INTEGER,
  PURCH_AMT INTEGER,
  ORDER_DATE TEXT,
  CUSTOMER_ID INTERGER,
  SALESMAN_ID INTEGER,
  FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID),
  FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMERS(CUSTOMER_ID)
);

INSERT INTO ORDERS (ORDER_ID, PURCH_AMT, ORDER_DATE, CUSTOMER_ID, SALESMAN_ID)
VALUES(70001, 150.5, '2012-10-05', 3005, 8),
(70009, 270.65, '2012-09-10', 3001, 4),
(70002, 65.26, '2012-10-05', 3003, 7),
(70004, 110.5, '2012-08-17', 3009, 5),
(70007, 948.5, '2012-09-10', 3005, 8),
(70005, 2400.6, '2012-07-27', 3007, 1);

SELECT SALESMAN.SALESMAN_ID, SALESMAN.NAME, CUSTOMERS.NAME, SALESMAN.CITY
FROM CUSTOMERS
JOIN SALESMAN ON SALESMAN.CITY = CUSTOMERS.CITY;

SELECT SALESMAN.SALESMAN_ID, SALESMAN.NAME, CUSTOMERS.CUSTOMER_ID, CUSTOMERS.NAME
FROM CUSTOMERS
JOIN SALESMAN ON SALESMAN.SALESMAN_ID = CUSTOMERS.SALESMAN_ID

SELECT ORDERS.ORDER_ID, CUSTOMERS.NAME, ORDERS. CUSTOMER_ID, ORDERS.SALESMAN_ID, CUSTOMERS.CITY, SALESMAN.CITY
FROM ORDERS
JOIN CUSTOMERS ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID
JOIN SALESMAN ON ORDERS.SALESMAN_ID = SALESMAN.SALESMAN_ID
WHERE CUSTOMERS.CITY = SALESMAN.CITY
